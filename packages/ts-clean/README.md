# ts-clean <!-- omit in toc --> 

`ts-clean` is a handy and lightweight tool for deleting build files, logs and 
installed modules without using shell, bash and extra command options. `ts-clean`
supports deep cleaning by specifying nested directory syntax in the command 
prompt. It means `ts-clean` is executable in the shell and bash environment. 

> :warning:
> 
> `ts-clean` will delete the specified files and directories permenantly.
> Please do run [`--dry-run`](#how-to-verify-the-file-and-directory-path-pattern) 
> for each command if the **file path pattern** is not listed in this file to prevent 
> file lost.


# Table of Content

- [Table of Content](#table-of-content)
- [How to install ts-clean](#how-to-install-ts-clean)
- [How to clean files and directories](#how-to-clean-files-and-directories)
  - [To clean up the installed module](#to-clean-up-the-installed-module)
  - [To clean up build files and logs](#to-clean-up-build-files-and-logs)
  - [To clean up specific files and folders](#to-clean-up-specific-files-and-folders)
    - [To clean up files and directories by File/Directory Name](#to-clean-up-files-and-directories-by-filedirectory-name)
    - [To clean up files and directories by File Extension](#to-clean-up-files-and-directories-by-file-extension)
    - [To clean up files and directories in the nested directory](#to-clean-up-files-and-directories-in-the-nested-directory)
      - [To clean up a particular file in the nested directory](#to-clean-up-a-particular-file-in-the-nested-directory)
      - [To clean up a folder in the nested directory](#to-clean-up-a-folder-in-the-nested-directory)
      - [To clean up files by file extension name in the nested directory](#to-clean-up-files-by-file-extension-name-in-the-nested-directory)
- [How to verify the file and directory path pattern](#how-to-verify-the-file-and-directory-path-pattern)
- [How to list options](#how-to-list-options)

# How to install ts-clean

`ts-clean` is a public package and is available on the `GitHub` package registry 
only. There are a few steps that must be done before using it.
1. Add a new line of  `@OttoHung:registry=https://npm.pkg.github.com` into 
   the npm package file such as `~/.npmrc`. For example,
   ```bash
   @OttoHung:registry=https://npm.pkg.github.com
   ```
   If there are other lines in the npm package file, the new line would be:
   ```bash
   //npm.pkg.github.com/:_authToken=${PAT_TOKEN}
   @OttoHung:registry=https://npm.pkg.github.com #Add package registry here
   ``` 
1. Add `@OttoHung/ts-clean` into the `packages.json` for a single project. For 
   the monorepo, such as `yarn workspace`, it could be added to the 
   `packages.json` file in the root folder as well because the cleaning 
   activity is conducted for each workspace. `ts-clean` is not a 
   project-dependent package so it should be in the `devDependencies` 
   attribute. Please learn more about versions 
   [here](https://github.com/OttoHung/typescript.utils/packages/1456335).
   ```json
   {
       "devDependencies": {
           ...,
           "@OttoHung/ts-clean": "latest",
           ...
       }
   }
   ```

> `--installed` can be used with other options, such as `--recommend` and 
> `--dry-run`.


# How to clean files and directories

`ts-clean` provides several options for the user to clean common files and 
directories in the Typescript project listed as follows:

> It's highly recommended executing `ts-clean` at project root folder to 
> reduce the incorrect file path issue.
> Also, run `--dry-run` for each command if the file path pattern is not 
> listed in this file.


## To clean up the installed module

The reason to clean up the installed modules may be:
1. The installed packages don't work as expected such as files missing or 
   failing to upgrade.
2. To reduce the size of the project for packing such as storing projects 
   in a hard drive or an SD card.

To achieve these requirements, the `--installed` and `-i` option, can be 
used in the command line prompt:
```bash
ts-clean --installed
```
Or
```bash
ts-clean -i
```

If the project uses `yarn` to manage packages or uses `yarn workspace` to 
manage other sub-packages, please use the command as follows:
```bash
yarn run ts-clean --installed
```
Or
```bash
yarn run ts-clean -i
```

`--installed` option deletes `node_modules` directory in the root of the 
project folder and the sub-directories as well.
```
.
+-- node_modules            (To be deleted)
+-- workspaces
|   +-- package_1
|   |   +-- node_modules    (To be deleted)
|   +-- package_2
|   |   +-- node_modules    (To be deleted)
|
```


## To clean up build files and logs

In Typescript, `lib`, `bin` and `dist` folders may be generated by the 
compiler based on the `tsconfig.json` file. To have a set of fresh build 
files, `ts-clean` provides `--recommend` and `-r` option to 
clean up those compiler-generated folders.

```bash
ts-clean --recommend
```

`--recommend` also cleans up other compiler-generated files and logs of 
yarn, such as:
- `*.tsbuildinfo`
- `yarn-error.log`


## To clean up specific files and folders

`ts-clean` supports some ways to clean the files and folders up:
- File/Directory Name
- File Extension
- Nested Directory


### To clean up files and directories by File/Directory Name

`ts-clean` can be used to delete some particular files and folders by 
listing their name in the command prompt without limitation, for example:
```bash
ts-clean logs/summary.log tmp
```
This command deletes `summary.log` file from `logs` directory and `tmp` 
folder under `root` folder.
```
.
+-- bin
+-- dist
+-- logs
|   +-- summary.log (To be deleted)
+-- tmp             (To be deleted)
+-- src
+-- tests
```


### To clean up files and directories by File Extension

`ts-clean` also supports deleting files by using the file extension name 
with wildcards as follows:
```bash
ts-clean logs/*.log
```

```
.
+-- bin
+-- log
|   +-- summary.log (To be deleted)
|   +-- part_a.log (To be deleted)
|   +-- part_b.log (To be deleted)
+-- tests
```

> :warning:
> 
> `ts-clean` doesn't support wildcard file name in current release. 
> Please **DO NOT** use wildcard in the file name. For example, 
> `part_*.log` may delete all files with `log` file extension name.

### To clean up files and directories in the nested directory

Sometimes, the files to be cleaned up may reside in the sub directories 
across the whole project. The best way to clean up those files and folders 
is using `nested directory` syntax (`/**/`) to achieve it.


#### To clean up a particular file in the nested directory

For example, the following command prompt deletes `summary.log` in every package 
under `workspaces` directory:
```bash
ts-clean workspaces/**/summary.log
```

```
.
+-- bin
+-- dist
+-- workspaces
|   +-- summary.log
|   +-- package_a
|   |   +-- audit.log
|   +-- package_b
|   |   +-- summary.log     (To be deleted)
|   +-- package_c
|   |   +-- summary.log     (To be deleted)
|   +-- package_d
|   |   +-- summary.log     (To be deleted)
|
```


#### To clean up a folder in the nested directory

`ts-clean` can delete a folder in the nested directory by executing:
```bash
ts-clean /**/tmp
```
```
.
+-- bin
+-- dist
+-- tmp
+-- workspaces
|   +-- tmp         (To be deleted)
|   +-- package_a
|   +-- package_b
|   |   +-- tmp     (To be deleted)
|   +-- package_c
|   |   +-- tmp     (To be deleted)
|   +-- package_d
|   |   +-- tmp     (To be deleted)
|
```


#### To clean up files by file extension name in the nested directory

Sometimes, the files are generated by different modules and those are 
stored in different folders based on the implementation of the module.
Using `nested directory` syntax with file extension names could resolve
this problem.
```bash
ts-clean workspaces/**/*.log
```
```
.
+-- bin
+-- dist
+-- tmp
+-- workspaces
|   +-- audit.log
|   +-- package_a
|   +-- package_b
|   |   +-- summary.log     (To be deleted)
|   +-- package_c
|   |   +-- service.log     (To be deleted)
|   +-- package_d
|   |   +-- db.log          (To be deleted)
|
```


# How to verify the file and directory path pattern

The files deleted by `ts-clean` are not reverted. Run `--dry-run` before 
cleaning up the files and folders will be the best practice. `--dry-run` 
will list files and folders when those match the pattern without deleting 
any files and directories on the hard drive disk. To get the list by running:
```bash
ts-clean /**/tmp workspaces/ --dry-run
```


# How to list options

`ts-clean` provides `--help` and `-h`, for the user to list 
supported options by:
```bash
ts-clean --help
```